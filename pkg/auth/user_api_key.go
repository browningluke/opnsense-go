// Code generated by internal/generate/api/main.go; DO NOT EDIT.

package auth

import (
	"context"
	"fmt"
	"github.com/browningluke/opnsense-go/pkg/api"
)

// Data structs

type AddApiKeyResult struct {
	Result   string `json:"result"`
	Hostname string `json:"hostname"`
	Key      string `json:"key"`
	Secret   string `json:"secret"`
}

type ApiKeyResult struct {
	Username string `json:"username"`
	Key      string `json:"key"`
	Id       string `json:"id"`
}

type GetAllApiKeysResult struct {
	Total    int            `json:"total"`
	RowCount int            `json:"rowCount"`
	Current  int            `json:"current"`
	Rows     []ApiKeyResult `json:"rows"`
}

// UserAddApiKey executes the AddApiKey RPC call of the User controller
func (c *Controller) UserAddApiKey(ctx context.Context, username string) (*AddApiKeyResult, error) {

	callParams := []string{}
	bodyParams := make(map[string]interface{})

	callParams = append(callParams, username)

	callOpts := api.RPCOpts{
		BaseEndpoint:   "/auth/user/add_api_key",
		Method:         "POST",
		PathParameters: callParams,
		BodyParameters: bodyParams,
	}

	resultData := &AddApiKeyResult{}
	result, err := api.Call(c.Client(), ctx, callOpts, resultData)
	if err != nil {
		return nil, fmt.Errorf("AddApiKey call failed: %w", err)
	}
	return result, nil
}

// UserDeleteApiKey executes the DeleteApiKey RPC call of the User controller
func (c *Controller) UserDeleteApiKey(ctx context.Context, id string) (*api.ActionResult, error) {

	callParams := []string{}
	bodyParams := make(map[string]interface{})

	callParams = append(callParams, id)

	callOpts := api.RPCOpts{
		BaseEndpoint:   "/auth/user/del_api_key",
		Method:         "POST",
		PathParameters: callParams,
		BodyParameters: bodyParams,
	}

	resultData := &api.ActionResult{}
	result, err := api.Call(c.Client(), ctx, callOpts, resultData)
	if err != nil {
		return nil, fmt.Errorf("DeleteApiKey call failed: %w", err)
	}
	return result, nil
}

// UserGetAllApiKeys executes the GetAllApiKeys RPC call of the User controller
func (c *Controller) UserGetAllApiKeys(ctx context.Context) (*GetAllApiKeysResult, error) {

	callParams := []string{}
	bodyParams := make(map[string]interface{})

	callOpts := api.RPCOpts{
		BaseEndpoint:   "/auth/user/search_api_key",
		Method:         "GET",
		PathParameters: callParams,
		BodyParameters: bodyParams,
	}

	resultData := &GetAllApiKeysResult{}
	result, err := api.Call(c.Client(), ctx, callOpts, resultData)
	if err != nil {
		return nil, fmt.Errorf("GetAllApiKeys call failed: %w", err)
	}
	return result, nil
}
